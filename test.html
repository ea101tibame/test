<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<link rel="stylesheet" type="text/css" href="style.css">
		<title></title>
		<script src="js/jquery-latest.js"></script>
		<script src="http://code.jquery.com/jquery-1.12.4.min.js"></script>
   		<script type="text/javascript">

   		</script>		

	</head>
	<body>


		<div id="calendar">	
		<h1 align="center">同學課表</h1>		
		<br>
		<div class='monyyyy'>
			<div >
				<div id="lastM"><<</div>
			</div>
			<div id = "MD"></div>
			<div >
				<div id="nextM" >>></div>
			</div>
		</div>
			<div id="calcontainer">
				<div id="calheader">
				</div>		
				<div id="daysweek">
					<div class="dayweek">  <p>Sunday</p></div>
					<div class="dayweek"> <p>M  onday</p></div>
					<div class="dayweek" ><p>Tuesday</p></div>
					<div class="dayweek"><p>Wednesday</p></div>
					<div class="dayweek"><p>Thursday</p></div>
					<div class="dayweek"><p>Friday</p></div>
					<div class="dayweek  brn"><p>Saturday</p></div>
					
				</div>
				<div id="daysmonth">
<!---------------------------------------- week 1 ---------------------------------------->
					<div class="week">
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
					</div>	
<!---------------------------------------- week 2 ---------------------------------------->
					<div class="week">
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
					</div>	
<!---------------------------------------- week 3 ---------------------------------------->
					<div class="week">
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
					</div>	
<!---------------------------------------- week 4 ---------------------------------------->
					<div class="week">
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
					</div>		
<!---------------------------------------- week 5 ---------------------------------------->
					<div class="week">
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
					</div>	
<!---------------------------------------- week 6 ---------------------------------------->
					<div class="week">
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
						<div class="day"></div>	
					</div>	
<!---------------------------------------- week 6 END ---------------------------------------->
				</div>				
			</div>					
			<div id="calcat">
				<div class="caldot orange"></div><p>有課</p>
				<div class="caldot none"></div><p>可預約</p><br>
</div>				
</div>	
</div>
<script type="text/javascript">

	//var date=2020-06-01 10:00:00.0;
// dateObjectName = new Date([parameters]);
var dots = document.getElementsByClassName("dots");
//console.log(dots);

var open = document.getElementsByClassName("open");
//console.log(open);

var none = document.getElementsByClassName("none");
//console.log(none);

function initMenu() {
	var monthName = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];//取值剛好4傳3 索引值3就是四月

    	//抓DOM
   	var lastM = document.getElementById("lastM");//要改變的按鈕 上個月
   	var MD = document.getElementById("MD");//填 現在的年月
   	var nextM = document.getElementById("nextM");//要改變的按鈕 下個月
   	var daybar = document.getElementsByClassName("daybar");//要插入日期的地方
// console.log(daybar);
	var addNoneAday = document.getElementsByClassName("day");
	// console.log(addNoneAday);
	for (var i = 0; i < 42; i++) {
		addNoneAday[i].innerHTML=`
							<div class="daybar"></div>
							<div class="dots">
								<ul>
									<li class="none"></li>
									<li class="none"></li>
									<li class="none"></li>

								</ul>
							</div>	
							
							<div class="open">
								<ul>
									<li class="none l4 a1"><p></p></li>
									<li class="none l4 a1"><p></p></li>	
									<li class="none l4 a1"><p></p></li>			
								</ul>
							</div>								
						`;	
	}
	
function getDate(year,month,week,allday){
	var year = year;
	var month = month;
	var week = week;
	var allday = allday;
	console.log("此月當前年份 = "+year);
	console.log("此月當前月份 = "+(month+1));
	console.log("此月星期幾為開始日 = "+week);
	console.log("此月共有幾天 = "+allday);
	console.log("");
}

   	function calender(daynow){
    		var year = Y;//現在的年
    		var month = M;//現在的月
    		var week = D;
    		var day = 1;//從一開始的日期 只是拿來當FOR的起始
    		var allday = isLeap(Y,M);//拿到當月日期總天數
    		resetAll();
    		for(day=1; day<=allday ; day++){
    			//從星期幾開始 加上put位置從0開始 day要減一
    			daybar[week+day-1].innerText=day;
    			// console.log(day);
    		}  		
    		MD.innerText = monthName[M] +" "+ Y;
    		getDate(year,month,week,allday);
    	}
    	//現在時間
		function daynow(){
			today = new Date();
			D = today.getDay();//week 0是週日 1是一
			M = today.getMonth();//4月是傳3
			Y = today.getFullYear();
			var endDate = isLeap(Y);
			return today;
		}
		//閏年判斷
		function isLeap(Y,M){
			var isLeapYear = false;
			var feb_end = 28;
			if (Y % 4 === 0){
				isLeapYear = true;
				feb_end = 29;
			}
			if (Y % 100 === 0){
				isLeapYear = false;    
			}
			if (Y % 400 === 0){
				isLeapYear = true;
				feb_end = 29;
			}
			var lastd = [31, feb_end, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
			return lastd[M];
		}
		//清除當前的日期
    	function resetAll(){
    		for(var i = 0 ; i<=41;i++){
    			daybar[i].innerHTML="-";
    		}

    	}
    	//改變下個月
    	function changeN(daynow){
    		var countM = 1;
    		var countY = 0;
    		newday = new Date(Y+countY,M+countM,1);

    		if((M+countM)==12){
    			countY++;
    		}

			D = newday.getDay();//week 0是週日 1是一
			M = newday.getMonth();//4月是傳3
			Y = newday.getFullYear();
			var endDate = isLeap(Y);
			return newday;
		}

		//改變上個月
    	function changeL(daynow){
    		var countM = 1;
    		var countY = 0;
    		newday = new Date(Y-countY,M-countM,1);

    		if((M-countM)==1){
    			countY--;
    		}

			D = newday.getDay();//week 0是週日 1是一
			M = newday.getMonth();//4月是傳3
			Y = newday.getFullYear();
			var endDate = isLeap(Y);
			return newday;
		}

//註冊事件 往上個月
	lastM.addEventListener("click",function(e){
		changeL();
		calender();
	});

//註冊事件 往下個月
	nextM.addEventListener("click",function(e){
		changeN();
		calender();
	});

	calender(daynow());
//動態效果
				var block = $(".day");
					block.addClass("clickable");
					block.hover(function(){window.status = $(this)}, function(){window.status = ""});
				
				$('.open').hide();
				block.click(
					function() {
						$(this).parents('div:eq(0)').find('.open').slideToggle('fast');	
					}
				);}
			$(document).ready(function() {initMenu();});

</script>
</body>
</html>